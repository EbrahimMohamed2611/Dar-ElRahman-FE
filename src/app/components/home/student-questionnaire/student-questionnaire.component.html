@if (rowSelected) {
  <div class="d-flex justify-content-between details-container">
    <div class="card">
      <div class="card-body">
        <h3 class="card-title">بيانات الطالب</h3>
        <p class="d-flex justify-content-between">
          <strong>رقم المسلسل:</strong> {{ rowSelected?.student?.id }}
        </p>
        <p class="d-flex justify-content-between">
          <strong>الاسم رباعي:</strong> {{ rowSelected?.student?.fullName }}
        </p>
        <p class="d-flex justify-content-between">
          <strong>الرقم القومي:</strong> {{ rowSelected?.student?.nationalId }}
        </p>
        <p class="d-flex justify-content-between">
          <strong>الحالة:</strong>
          <span
            class="green-status"
            [ngClass]="{
            'green-status': rowSelected?.student?.status === 'CONNECTED',
            'green-danger': rowSelected?.student?.status === 'STOPPED'
          }"
          >{{ rowSelected?.student?.status === "STOPPED" ? "منقطع" : "متصل" }}</span
          >
        </p>
      </div>
    </div>

    <div class="card">
      <div class="card-body">
        <h3 class="card-title">تفاصيل السؤال</h3>
        <p class="d-flex justify-content-between">
          <strong>رقم المسلسل:</strong> {{ rowSelected?.questionnaire?.id }}
        </p>
        <p class="d-flex justify-content-between">
          <strong>نوع
            الحفظ:</strong> {{ rowSelected?.questionnaire?.questionnaireType === QuestionnaireType.memorization ? 'تسميع' : 'مراجعة' }}
        </p>
        <p class="d-flex justify-content-between">
          <strong>نوع
            السؤال:</strong> {{ rowSelected?.questionnaire?.questionType === QuestionType.first ? 'أول' : (rowSelected?.questionnaire?.questionType === QuestionType.second ? 'ثالث' : 'ثانى') }}
        </p>
        <p class="d-flex justify-content-between">
          <strong>تاريخ السؤال:</strong> {{ rowSelected?.questionnaire?.questionDate | date: 'yyyy-MM-dd' }}
        </p>
        <p class="d-flex justify-content-between">
          <strong>السورة الحالية:</strong> {{ rowSelected?.questionnaire?.currentSurah?.nameAr }}
        </p>
        <p class="d-flex justify-content-between">
          <strong>الحلقة:</strong> {{ rowSelected?.questionnaire?.ring?.name }}
        </p>
      </div>
    </div>
  </div>
}

<div class="container">
  <h2>إضافة نتيجة طالب آخر</h2>
  <form [formGroup]="studentQuestionnaireForm" (ngSubmit)="onSubmit()">
    <div class="form-group">
      <label for="ring">Ring</label>
      <select id="ring" formControlName="ringId" (change)="onRingChange($event)">
        <option value="">Select Ring</option>
        <option *ngFor="let ring of rings" [value]="ring.id">{{ ring.name }}</option>
      </select>
    </div>

    <div class="form-group">
      <label for="questionnaire">Questionnaire</label>
      <select id="questionnaire" formControlName="questionnaireId" (change)="onQuestionnaireChange($event)">
        <option value="">Select Questionnaire</option>
        <option *ngFor="let q of questionnaires" [value]="q.id">{{ q.questionnaireType }}
          - {{ q.questionDate | date }}
        </option>
      </select>
    </div>

    <div class="form-group">
      <label for="student">Student</label>
      <select id="student" formControlName="studentId">
        <option value="">Select Student</option>
        <option *ngFor="let student of students" [value]="student.id">{{ student.fullName }}</option>
      </select>
    </div>

    <div class="form-group">
      <label for="grade">Grade</label>
      <select id="grade" formControlName="grade">
        <option value="">Select Grade</option>
        <option *ngFor="let grade of grades" [value]="grade">{{ grade }}</option>
      </select>
    </div>

    <button type="submit" [disabled]="!studentQuestionnaireForm.valid">Add</button>
  </form>

  <hr>

  <h2>Filter Student Questionnaires</h2>
  <form [formGroup]="filterForm" class="filter-form">
    <div class="form-group">
      <label for="filter-ring">Ring</label>
      <select id="filter-ring" formControlName="ringId">
        <option value="">All Rings</option>
        <option *ngFor="let ring of rings" [value]="ring.id">{{ ring.name }}</option>
      </select>
    </div>

    <div class="form-group">
      <label for="filter-questionnaire">Questionnaire</label>
      <select id="filter-questionnaire" formControlName="questionnaireId">
        <option value="">All Questionnaires</option>
        <option *ngFor="let q of questionnaires" [value]="q.id">{{ q.questionnaireType }}
          - {{ q.questionDate | date }}
        </option>
      </select>
    </div>

    <div class="form-group">
      <label for="filter-student">Student</label>
      <select id="filter-student" formControlName="studentId">
        <option value="">All Students</option>
        <option *ngFor="let student of students" [value]="student.id">{{ student.fullName }}</option>
      </select>
    </div>
  </form>

  <h2>أسئلة الطلبة</h2>
  <table>
    <thead>
    <tr>
      <th>Student</th>
      <th>Questionnaire</th>
      <th>Ring</th>
      <th>Grade</th>
      <th>Success Date</th>
      <th>Done</th>
    </tr>
    </thead>
    <tbody>
    <tr *ngFor="let sq of studentQuestionnaires">
      <td>{{ sq.student?.fullName }}</td>
      <td>{{ sq.questionnaire?.questionnaireType }} - {{ sq.questionnaire?.questionDate | date }}</td>
      <td>{{ sq.questionnaire?.ring?.name }}</td>
      <td>{{ sq.grade }}</td>
      <td>{{ sq.successDate | date }}</td>
      <td>{{ sq.done ? 'Yes' : 'No' }}</td>
    </tr>
    </tbody>
  </table>
</div>
